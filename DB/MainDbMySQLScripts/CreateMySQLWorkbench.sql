-- MySQL Script generated by MySQL Workbench
-- 11/06/14 14:35:01
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema PupilBook
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `PupilBook` ;

-- -----------------------------------------------------
-- Schema PupilBook
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `PupilBook` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci ;
USE `PupilBook` ;

-- -----------------------------------------------------
-- Table `PupilBook`.`SchoolYear`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`SchoolYear` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`SchoolYear` (
  `idSchoolYear` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(20) NOT NULL,
  `isactualyear` TINYINT(1) NOT NULL,
  `StartDate` DATE NOT NULL,
  `EndDate` DATE NOT NULL,
  PRIMARY KEY (`idSchoolYear`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`StudyGroup`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`StudyGroup` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`StudyGroup` (
  `idStudyGroup` INT NOT NULL AUTO_INCREMENT,
  `Name` VARCHAR(45) NOT NULL,
  `SchoolYear_idSchoolYear` INT NOT NULL,
  PRIMARY KEY (`idStudyGroup`),
  INDEX `fk_StudyGroup_SchoolYear_idx` (`SchoolYear_idSchoolYear` ASC),
  CONSTRAINT `fk_StudyGroup_SchoolYear`
    FOREIGN KEY (`SchoolYear_idSchoolYear`)
    REFERENCES `PupilBook`.`SchoolYear` (`idSchoolYear`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`StudySubject`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`StudySubject` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`StudySubject` (
  `idStudySubject` INT NOT NULL AUTO_INCREMENT,
  `Name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idStudySubject`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`Users`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`Users` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`Users` (
  `FirstName` VARCHAR(45) NOT NULL,
  `MiddleName` VARCHAR(45) NULL,
  `LastName` VARCHAR(45) NOT NULL,
  `Phone` VARCHAR(15) NULL,
  `Email` VARCHAR(100) NULL,
  `Login` VARCHAR(255) NOT NULL,
  `Password` VARCHAR(255) NOT NULL,
  `BirthDate` DATE NULL,
  `StudyGroup_idStudyGroup` INT NULL,
  `Role` CHAR(1) NOT NULL,
  UNIQUE INDEX `Login_UNIQUE` (`Login` ASC),
  INDEX `fk_Users_StudyGroup1_idx` (`StudyGroup_idStudyGroup` ASC),
  PRIMARY KEY (`Login`),
  CONSTRAINT `fk_Users_StudyGroup1`
    FOREIGN KEY (`StudyGroup_idStudyGroup`)
    REFERENCES `PupilBook`.`StudyGroup` (`idStudyGroup`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`SheduleItem`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`SheduleItem` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`SheduleItem` (
  `idSheduleItem` INT NOT NULL AUTO_INCREMENT,
  `day` TINYINT(1) NOT NULL,
  `hour` TINYINT(1) NULL,
  `StudyGroup_idStudyGroup` INT NOT NULL,
  `StudySubject_idStudySubject` INT NOT NULL,
  `Users_Login` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`idSheduleItem`),
  UNIQUE INDEX `hour_UNIQUE` (`hour` ASC),
  INDEX `fk_SheduleItem_StudyGroup1_idx` (`StudyGroup_idStudyGroup` ASC),
  INDEX `fk_SheduleItem_StudySubject1_idx` (`StudySubject_idStudySubject` ASC),
  INDEX `fk_SheduleItem_Users1_idx` (`Users_Login` ASC),
  CONSTRAINT `fk_SheduleItem_StudyGroup1`
    FOREIGN KEY (`StudyGroup_idStudyGroup`)
    REFERENCES `PupilBook`.`StudyGroup` (`idStudyGroup`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SheduleItem_StudySubject1`
    FOREIGN KEY (`StudySubject_idStudySubject`)
    REFERENCES `PupilBook`.`StudySubject` (`idStudySubject`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_SheduleItem_Users1`
    FOREIGN KEY (`Users_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`Attendance`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`Attendance` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`Attendance` (
  `idAttendance` INT NOT NULL AUTO_INCREMENT,
  `MissingStart` DATETIME NOT NULL,
  `MissingEnd` DATETIME NULL,
  `Excussed` TINYINT(1) NOT NULL,
  `Users_Login` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`idAttendance`),
  INDEX `fk_Attendance_Users1_idx` (`Users_Login` ASC),
  CONSTRAINT `fk_Attendance_Users1`
    FOREIGN KEY (`Users_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`ParrentStudent`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`ParrentStudent` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`ParrentStudent` (
  `idParrentStudent` INT NOT NULL AUTO_INCREMENT,
  `Student_Login` VARCHAR(255) NOT NULL,
  `Parent_Login` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`idParrentStudent`),
  INDEX `fk_ParrentStudent_Users1_idx` (`Student_Login` ASC),
  INDEX `fk_ParrentStudent_Users2_idx` (`Parent_Login` ASC),
  CONSTRAINT `fk_ParrentStudent_Users1`
    FOREIGN KEY (`Student_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ParrentStudent_Users2`
    FOREIGN KEY (`Parent_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`Teacher_Subjects`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`Teacher_Subjects` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`Teacher_Subjects` (
  `idTeacher_Subjects` INT NOT NULL,
  `Users_Login` VARCHAR(255) NOT NULL,
  `StudySubject_idStudySubject` INT NOT NULL,
  PRIMARY KEY (`idTeacher_Subjects`),
  INDEX `fk_Teacher_Subjects_Users1_idx` (`Users_Login` ASC),
  INDEX `fk_Teacher_Subjects_StudySubject1_idx` (`StudySubject_idStudySubject` ASC),
  CONSTRAINT `fk_Teacher_Subjects_Users1`
    FOREIGN KEY (`Users_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Teacher_Subjects_StudySubject1`
    FOREIGN KEY (`StudySubject_idStudySubject`)
    REFERENCES `PupilBook`.`StudySubject` (`idStudySubject`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`Results`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`Results` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`Results` (
  `idResults` INT NOT NULL,
  `Description` VARCHAR(255) NULL,
  `Score` TINYINT(1) NOT NULL,
  `Date` DATETIME NULL,
  `Teacher_Login` VARCHAR(255) NOT NULL,
  `Student_Login` VARCHAR(255) NOT NULL,
  `StudySubject_idStudySubject` INT NOT NULL,
  PRIMARY KEY (`idResults`),
  INDEX `fk_Results_Users1_idx` (`Teacher_Login` ASC),
  INDEX `fk_Results_Users2_idx` (`Student_Login` ASC),
  INDEX `fk_Results_StudySubject1_idx` (`StudySubject_idStudySubject` ASC),
  CONSTRAINT `fk_Results_Users1`
    FOREIGN KEY (`Teacher_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Results_Users2`
    FOREIGN KEY (`Student_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Results_StudySubject1`
    FOREIGN KEY (`StudySubject_idStudySubject`)
    REFERENCES `PupilBook`.`StudySubject` (`idStudySubject`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `PupilBook`.`informations`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `PupilBook`.`informations` ;

CREATE TABLE IF NOT EXISTS `PupilBook`.`informations` (
  `idinformations` INT NOT NULL,
  `Description` VARCHAR(100) NOT NULL,
  `InfoForParrents` TINYINT(1) NOT NULL,
  `SomeMessage` VARCHAR(2000) NOT NULL,
  `CreateDate` DATETIME NOT NULL,
  `StudyGroup_idStudyGroup` INT NOT NULL,
  `Users_Login` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`idinformations`),
  INDEX `fk_informations_StudyGroup1_idx` (`StudyGroup_idStudyGroup` ASC),
  INDEX `fk_informations_Users1_idx` (`Users_Login` ASC),
  CONSTRAINT `fk_informations_StudyGroup1`
    FOREIGN KEY (`StudyGroup_idStudyGroup`)
    REFERENCES `PupilBook`.`StudyGroup` (`idStudyGroup`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_informations_Users1`
    FOREIGN KEY (`Users_Login`)
    REFERENCES `PupilBook`.`Users` (`Login`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
